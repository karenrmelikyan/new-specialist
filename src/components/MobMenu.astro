---
import Icon from '../components/Icon.astro'
---

<div class="mbmenu">
    <!-- Bottom bar -->
    <div class="mbmenu-bottom">
        <label for="toggle-menu" class="mbmenu-item">
            <Icon name="repair" />
            <span>Все услуги</span>
        </label>
        <button class="mbmenu-item">
            <Icon name="plus" />
            <span>Заявка</span>
        </button>
        <button class="mbmenu-item">
            <Icon name="hamburger" />
            <span>Меню</span>
        </button>
    </div>

    <!-- Hidden inputs to control modal and levels -->
    <input type="checkbox" id="toggle-menu" hidden>
    <input type="radio" name="mbmenu-level" id="level1" checked hidden>
    <input type="radio" name="mbmenu-level" id="level2-smas" hidden>
    <input type="radio" name="mbmenu-level" id="level2-fridge" hidden>
    <input type="radio" name="mbmenu-level" id="level3-smas" hidden>
    <input type="radio" name="mbmenu-level" id="level3-fridge" hidden>

    <!-- Modal -->
    <div class="mbmenu-modal">
        <div class="mbmenu-header">
            <!-- Back buttons -->
            <label for="level1" class="mbmenu-back back-2">
                <svg width="35" height="35" viewBox="0 0 24 24" fill="none">
                    <path d="M15 18l-6-6 6-6" stroke="#3f3d63" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </label>
            <label for="level2-smas" class="mbmenu-back back-3-smas">
                <svg width="35" height="35" viewBox="0 0 24 24" fill="none">
                    <path d="M15 18l-6-6 6-6" stroke="#3f3d63" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </label>
            <label for="level2-fridge" class="mbmenu-back back-3-fridge">
                <svg width="35" height="35" viewBox="0 0 24 24" fill="none">
                    <path d="M15 18l-6-6 6-6" stroke="#3f3d63" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </label>

            <!-- Close -->
            <label for="toggle-menu" class="mbmenu-close">✕</label>

            <!-- Titles -->
            <div class="mbmenu-title">
                <span class="title-1">Все услуги</span>
                <span class="title-2">Ремонт техники</span>
                <span class="title-3-smas">Стиральные машины</span>
                <span class="title-3-fridge">Холодильники</span>
            </div>
        </div> <!-- /.mbmenu-header -->

        <div class="mbmenu-wrapper">
            <!-- LEVEL 1 -->
            <div class="mbmenu-view view-1">
                <label for="level2-smas" class="mbmenu-item-row">
                   <span class="row-left">
                        <Icon name="repair" />
                        Ремонт техники
                    </span>
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M8 5l8 7-8 7" stroke="#3f3d63" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </label>
            </div> <!-- /.view-1 -->

            <!-- LEVEL 2 -->
            <div class="mbmenu-view view-2">
                <div class="mbmenu-section">Ремонт техники</div>
                <label for="level3-smas" class="mbmenu-item-row">
                    Стиральные машины
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M8 5l8 7-8 7" stroke="#3f3d63" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </label>
                <label for="level3-fridge" class="mbmenu-item-row">
                    Холодильники
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M8 5l8 7-8 7" stroke="#3f3d63" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </label>
            </div> <!-- /.view-2 -->

            <!-- LEVEL 3 - Стиральные машины -->
            <div class="mbmenu-view view-3 view-3-smas">
                <div class="mbmenu-section">Стиральные машины</div>
                <div class="mbmenu-item-row">Не сливает</div>
                <div class="mbmenu-item-row">Не отжимает</div>
                <div class="mbmenu-item-row">Замена подшипника</div>
                <div class="mbmenu-item-row">Замена ТЭНа</div>
            </div> <!-- /.view-3-smas -->

            <!-- LEVEL 3 - Холодильники -->
            <div class="mbmenu-view view-3 view-3-fridge">
                <div class="mbmenu-section">Холодильники</div>
                <div class="mbmenu-item-row">Не морозит</div>
                <div class="mbmenu-item-row">Заправка фреоном</div>
                <div class="mbmenu-item-row">Замена компрессора</div>
            </div> <!-- /.view-3-fridge -->
        </div> <!-- /.mbmenu-wrapper -->
    </div> <!-- /.mbmenu-modal -->
</div> <!-- /.mbmenu -->

<style>
    /* ---------------------- BOTTOM BAR ---------------------- */
    .mbmenu-bottom {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        display: none;
        justify-content: space-between;
        padding: 10px 20px;
        background: var(--main-background-color);
        border-top: 1px solid var(--main-background-color);
        border-radius: 16px 16px 0 0;
        z-index: 3000;
    }

    .mbmenu-item {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 6px;
        background: none;
        border: none;
        font-size: 13px;
        color: var(--main-font-color);
        font-weight: var(--font-weight);
        cursor: pointer;
    }

    /* ---------------------- MODAL ---------------------- */
    .mbmenu-modal {
        position: fixed;
        inset: 0;
        display: flex;
        flex-direction: column;
        background: var(--main-background-color);
        transform: translateY(100%);
        transition: transform 0.35s;
        z-index: 2000;
    }

    #toggle-menu:checked ~ .mbmenu-modal {
        transform: translateY(0);
    }

    /* ---------------------- HEADER ---------------------- */
    .mbmenu-header {
        height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        font-size: calc(var(--middle) - 5px);
        font-weight: var(--font-weight);
        padding: 0 20px;
    }

    .mbmenu-back,
    .mbmenu-close {
        position: absolute;
        top: 0;
        bottom: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        background: none;
        border: none;
        font-size: 25px;
        padding-left: 15px;
        padding-right: 20px;
        color: var(--main-font-color);
        cursor: pointer;
    }

    .mbmenu-back { left: 0; display: none; }
    .mbmenu-close { right: 0; }

    /* ---------------------- BACK BUTTON VISIBILITY ---------------------- */
    #level2-smas:checked ~ .mbmenu-modal .back-2,
    #level2-fridge:checked ~ .mbmenu-modal .back-2,
    #level3-smas:checked ~ .mbmenu-modal .back-3-smas,
    #level3-fridge:checked ~ .mbmenu-modal .back-3-fridge {
        display: flex;
    }

    /* ---------------------- TITLES ---------------------- */
    .mbmenu-title span { display: none; }
    #level1:checked ~ .mbmenu-modal .title-1 { display: inline; }
    #level2-smas:checked ~ .mbmenu-modal .title-2,
    #level2-fridge:checked ~ .mbmenu-modal .title-2 { display: inline; }
    #level3-smas:checked ~ .mbmenu-modal .title-3-smas { display: inline; }
    #level3-fridge:checked ~ .mbmenu-modal .title-3-fridge { display: inline; }

    /* ---------------------- WRAPPER ---------------------- */
    .mbmenu-wrapper {
        position: relative;
        flex: 1;
        overflow: hidden;
    }

    /* ---------------------- VIEWS / SLIDES ---------------------- */
    .mbmenu-view {
        position: absolute;
        inset: 0;
        padding: 20px;
        overflow-y: auto;
        transform: translateX(100%);
        transition: transform 0.35s cubic-bezier(.4,0,.2,1);
        background: var(--main-background-color);
    }

    /* LEVEL VISIBILITY */
    #level1:checked ~ .mbmenu-modal .view-1 { transform: translateX(0); }
    #level2-smas:checked ~ .mbmenu-modal .view-2,
    #level2-fridge:checked ~ .mbmenu-modal .view-2 { transform: translateX(0); }
    #level3-smas:checked ~ .mbmenu-modal .view-3-smas { transform: translateX(0); }
    #level3-fridge:checked ~ .mbmenu-modal .view-3-fridge { transform: translateX(0); }

    /* PREVIOUS SLIDE POSITIONING */
    #level2-smas:checked ~ .mbmenu-modal .view-1,
    #level2-fridge:checked ~ .mbmenu-modal .view-1 { transform: translateX(-100%); }
    #level3-smas:checked ~ .mbmenu-modal .view-2 { transform: translateX(-100%); }
    #level3-fridge:checked ~ .mbmenu-modal .view-2 { transform: translateX(-100%); }

    /* ---------------------- MENU ROWS ---------------------- */
    .mbmenu-item-row {
        padding: 8px 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: var(--small);
        cursor: pointer;
        border-radius: 8px;
        transition: background 0.2s;
    }

    .mbmenu-item-row:hover {
        background: var(--main-font-hover);
    }

    .mbmenu-item-row svg {
        width: 18px;
        height: 18px;
        margin-left: 6px;
        flex-shrink: 0;
        margin-top: 2px;
    }

    .mbmenu-item-row .row-left {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    /* ---------------------- SECTIONS ---------------------- */
    .mbmenu-section {
        padding: 8px 0;
        font-weight: var(--font-weight);
        font-size: var(--small);
    }

    /* ---------------------- BREAKPOINTS ---------------------- */
    @media (max-width: 1200px) { .mbmenu-bottom { display: flex; } }
    @media (max-width: 768px) { .mbmenu-bottom { padding: 8px 10px; } }
</style>
